{
  "name" : "JSON load2Redshift",
  "jobMode" : "VISUAL",
  "description" : "",
  "role" : "arn:aws:iam::863518427397:role/tmg-glue-service-role",
  "executionProperty" : {
    "maxConcurrentRuns" : 1
  },
  "command" : {
    "name" : "glueetl",
    "scriptLocation" : "s3://aws-glue-assets-863518427397-ap-southeast-1/scripts/JSON load2Redshift.py",
    "pythonVersion" : "3"
  },
  "defaultArguments" : {
    "--enable-metrics" : "true",
    "--enable-spark-ui" : "true",
    "--extra-py-files" : "s3://aws-glue-studio-transforms-737106620487-prod-ap-southeast-1/gs_common.py,s3://aws-glue-studio-transforms-737106620487-prod-ap-southeast-1/gs_format_timestamp.py,s3://aws-glue-studio-transforms-737106620487-prod-ap-southeast-1/gs_array_to_cols.py,s3://aws-glue-studio-transforms-737106620487-prod-ap-southeast-1/gs_explode.py,s3://aws-glue-studio-transforms-737106620487-prod-ap-southeast-1/gs_flatten.py",
    "--spark-event-logs-path" : "s3://aws-glue-assets-863518427397-ap-southeast-1/sparkHistoryLogs/",
    "--enable-job-insights" : "true",
    "--enable-observability-metrics" : "true",
    "--enable-glue-datacatalog" : "true",
    "--enable-continuous-cloudwatch-log" : "true",
    "--job-bookmark-option" : "job-bookmark-disable",
    "--job-language" : "python",
    "--TempDir" : "s3://aws-glue-assets-863518427397-ap-southeast-1/temporary/"
  },
  "connections" : {
    "connections" : [ "redshift-jdbc-tmg-rs-poc" ]
  },
  "maxRetries" : 0,
  "allocatedCapacity" : 2,
  "timeout" : 480,
  "maxCapacity" : 2.0,
  "glueVersion" : "5.0",
  "numberOfWorkers" : 2,
  "workerType" : "G.1X",
  "executionClass" : "STANDARD",
  "codeGenConfigurationNodes" : "{\"node-1741667366290\":{\"DynamicTransform\":{\"FunctionName\":\"gs_format_timestamp\",\"Inputs\":[\"node-1741667302392\"],\"Name\":\"Format Timestamp\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"LATITUDE\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"LONGITUDE\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"houry_time\",\"Type\":\"timestamp\"},{\"Name\":\"FORECAST_TEMP\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"hourly_units.temperature_2m\",\"Type\":\"string\"},{\"Name\":\"FORECAST_DATE\",\"Type\":\"string\"},{\"Name\":\"FORECAST_TIME\",\"Type\":\"string\"}]}],\"Parameters\":[{\"IsOptional\":false,\"Name\":\"colName\",\"Type\":\"str\",\"Value\":[\"houry_time\"]},{\"IsOptional\":false,\"Name\":\"dateFormat\",\"Type\":\"str\",\"Value\":[\"HH:mm:ss\"]},{\"IsOptional\":true,\"Name\":\"newColName\",\"Type\":\"str\",\"Value\":[\"FORECAST_TIME\"]}],\"Path\":\"s3://aws-glue-studio-transforms-737106620487-prod-ap-southeast-1/gs_format_timestamp.py\",\"TransformName\":\"gs_format_timestamp\",\"Version\":\"1.0.0\"}},\"node-1741667217545\":{\"ApplyMapping\":{\"Inputs\":[\"node-1741666596266\"],\"Mapping\":[{\"Dropped\":false,\"FromPath\":[\"latitude\"],\"FromType\":\"double\",\"ToKey\":\"LATITUDE\",\"ToType\":\"decimal\"},{\"Dropped\":false,\"FromPath\":[\"longitude\"],\"FromType\":\"double\",\"ToKey\":\"LONGITUDE\",\"ToType\":\"decimal\"},{\"Dropped\":false,\"FromPath\":[\"houry_time\"],\"FromType\":\"string\",\"ToKey\":\"houry_time\",\"ToType\":\"timestamp\"},{\"Dropped\":false,\"FromPath\":[\"houry_temp\"],\"FromType\":\"double\",\"ToKey\":\"FORECAST_TEMP\",\"ToType\":\"decimal\"}],\"Name\":\"Change Schema\"}},\"node-1741666596266\":{\"SelectFields\":{\"Inputs\":[\"node-1741666351668\"],\"Name\":\"Select Fields\",\"Paths\":[[\"latitude\"],[\"longitude\"],[\"houry_time\"],[\"houry_temp\"],[\"hourly_units.temperature_2m\"]]}},\"node-1741664181373\":{\"S3JsonSource\":{\"AdditionalOptions\":{\"EnableSamplePath\":false,\"SamplePath\":\"s3://tmg-s3-raw-poc/forecast_json/run-jsontarget_node1740995900132-1-part-r-00000\"},\"Exclusions\":[],\"JsonPath\":\"\",\"Multiline\":false,\"Name\":\"Amazon S3\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"latitude\",\"Type\":\"double\"},{\"Name\":\"longitude\",\"Type\":\"double\"},{\"Name\":\"generationtime_ms\",\"Type\":\"double\"},{\"Name\":\"utc_offset_seconds\",\"Type\":\"int\"},{\"Name\":\"timezone\",\"Type\":\"string\"},{\"Name\":\"timezone_abbreviation\",\"Type\":\"string\"},{\"Name\":\"elevation\",\"Type\":\"double\"},{\"Name\":\"hourly_units\",\"Type\":\"struct<time:string,temperature_2m:string>\"},{\"Name\":\"hourly\",\"Type\":\"struct<time:array<string>,temperature_2m:array<double>>\"}]}],\"Paths\":[\"s3://tmg-s3-raw-poc/forecast_json/\"],\"Recurse\":true}},\"node-1741664612446\":{\"S3DirectTarget\":{\"AutoDataQuality\":{\"EvaluationContext\":\"EvaluateDataQuality_node1741664158855\",\"IsEnabled\":false},\"Compression\":\"none\",\"Format\":\"json\",\"Inputs\":[\"node-1741668277070\"],\"Name\":\"Amazon S3\",\"PartitionKeys\":[],\"Path\":\"s3://tmg-s3-raw-poc/temp_json/\",\"SchemaChangePolicy\":{\"EnableUpdateCatalog\":false}}},\"node-1741667302392\":{\"DynamicTransform\":{\"FunctionName\":\"gs_format_timestamp\",\"Inputs\":[\"node-1741667217545\"],\"Name\":\"Format Timestamp\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"LATITUDE\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"LONGITUDE\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"houry_time\",\"Type\":\"timestamp\"},{\"Name\":\"FORECAST_TEMP\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"hourly_units.temperature_2m\",\"Type\":\"string\"},{\"Name\":\"FORECAST_DATE\",\"Type\":\"string\"}]}],\"Parameters\":[{\"IsOptional\":false,\"Name\":\"colName\",\"Type\":\"str\",\"Value\":[\"houry_time\"]},{\"IsOptional\":false,\"Name\":\"dateFormat\",\"Type\":\"str\",\"Value\":[\"yyyy-MM-dd\"]},{\"IsOptional\":true,\"Name\":\"newColName\",\"Type\":\"str\",\"Value\":[\"FORECAST_DATE\"]}],\"Path\":\"s3://aws-glue-studio-transforms-737106620487-prod-ap-southeast-1/gs_format_timestamp.py\",\"TransformName\":\"gs_format_timestamp\",\"Version\":\"1.0.0\"}},\"node-1741670971986\":{\"AmazonRedshiftTarget\":{\"Data\":{\"AccessType\":\"connection\",\"Action\":\"append\",\"AdvancedOptions\":[],\"Connection\":{\"Description\":\"JDBC for Redshift tmg-rs-poc, Database poc_dwh Version: 1\",\"Label\":\"redshift-jdbc-tmg-rs-poc\",\"Value\":\"redshift-jdbc-tmg-rs-poc\"},\"MergeAction\":\"simple\",\"MergeWhenMatched\":\"update\",\"MergeWhenNotMatched\":\"insert\",\"Schema\":{\"Label\":\"poc\",\"Value\":\"poc\"},\"SelectedColumns\":[],\"SourceType\":\"table\",\"StagingTable\":\"poc.th_weather_forecast_temp_32526g\",\"Table\":{\"Label\":\"th_weather_forecast\",\"Value\":\"th_weather_forecast\"},\"TableSchema\":[{\"Description\":\"DECIMAL\",\"Label\":\"LATITUDE\",\"Value\":\"LATITUDE\"},{\"Description\":\"DECIMAL\",\"Label\":\"LONGITUDE\",\"Value\":\"LONGITUDE\"},{\"Description\":\"DECIMAL\",\"Label\":\"FORECAST_TEMP\",\"Value\":\"FORECAST_TEMP\"},{\"Description\":\"VARCHAR\",\"Label\":\"FORECAST_TEMP_UNIT\",\"Value\":\"FORECAST_TEMP_UNIT\"},{\"Description\":\"DATE\",\"Label\":\"FORECAST_DATE\",\"Value\":\"FORECAST_DATE\"},{\"Description\":\"VARCHAR\",\"Label\":\"FORECAST_TIME\",\"Value\":\"FORECAST_TIME\"}],\"TempDir\":\"s3://aws-glue-assets-863518427397-ap-southeast-1/temporary/\",\"Upsert\":false},\"Inputs\":[\"node-1741668277070\"],\"Name\":\"Amazon Redshift\"}},\"node-1741666351668\":{\"DynamicTransform\":{\"FunctionName\":\"gs_array_to_cols\",\"Inputs\":[\"node-1741666107880\"],\"Name\":\"Array To Columns\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"latitude\",\"Type\":\"double\"},{\"Name\":\"longitude\",\"Type\":\"double\"},{\"Name\":\"generationtime_ms\",\"Type\":\"double\"},{\"Name\":\"utc_offset_seconds\",\"Type\":\"int\"},{\"Name\":\"timezone\",\"Type\":\"string\"},{\"Name\":\"timezone_abbreviation\",\"Type\":\"string\"},{\"Name\":\"elevation\",\"Type\":\"double\"},{\"Name\":\"hourly_units.time\",\"Type\":\"string\"},{\"Name\":\"hourly_units.temperature_2m\",\"Type\":\"string\"},{\"Name\":\"hourly.time\",\"Type\":\"array<string>\"},{\"Name\":\"hourly.temperature_2m\",\"Type\":\"array<double>\"},{\"Name\":\"houry_time\",\"Type\":\"string\"},{\"Name\":\"houry_temp\",\"Type\":\"double\"}]}],\"Parameters\":[{\"IsOptional\":false,\"Name\":\"colName\",\"Type\":\"str\",\"Value\":[\"`hourly.temperature_2m`\"]},{\"IsOptional\":false,\"Name\":\"colList\",\"Type\":\"str\",\"Value\":[\"houry_temp\"]}],\"Path\":\"s3://aws-glue-studio-transforms-737106620487-prod-ap-southeast-1/gs_array_to_cols.py\",\"TransformName\":\"gs_array_to_cols\",\"Version\":\"1.0.0\"}},\"node-1741666447976\":{\"DynamicTransform\":{\"FunctionName\":\"gs_flatten\",\"Inputs\":[\"node-1741664181373\"],\"Name\":\"Flatten\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"latitude\",\"Type\":\"double\"},{\"Name\":\"longitude\",\"Type\":\"double\"},{\"Name\":\"generationtime_ms\",\"Type\":\"double\"},{\"Name\":\"utc_offset_seconds\",\"Type\":\"int\"},{\"Name\":\"timezone\",\"Type\":\"string\"},{\"Name\":\"timezone_abbreviation\",\"Type\":\"string\"},{\"Name\":\"elevation\",\"Type\":\"double\"},{\"Name\":\"hourly_units.time\",\"Type\":\"string\"},{\"Name\":\"hourly_units.temperature_2m\",\"Type\":\"string\"},{\"Name\":\"hourly.time\",\"Type\":\"array<string>\"},{\"Name\":\"hourly.temperature_2m\",\"Type\":\"array<double>\"}]}],\"Parameters\":[{\"IsOptional\":true,\"Name\":\"maxLevels\",\"Type\":\"int\",\"Value\":[\"0\"]}],\"Path\":\"s3://aws-glue-studio-transforms-737106620487-prod-ap-southeast-1/gs_flatten.py\",\"TransformName\":\"gs_flatten\",\"Version\":\"1.0.0\"}},\"node-1741666107880\":{\"DynamicTransform\":{\"FunctionName\":\"gs_explode\",\"Inputs\":[\"node-1741666447976\"],\"Name\":\"Explode Array hourly.time\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"latitude\",\"Type\":\"double\"},{\"Name\":\"longitude\",\"Type\":\"double\"},{\"Name\":\"generationtime_ms\",\"Type\":\"double\"},{\"Name\":\"utc_offset_seconds\",\"Type\":\"int\"},{\"Name\":\"timezone\",\"Type\":\"string\"},{\"Name\":\"timezone_abbreviation\",\"Type\":\"string\"},{\"Name\":\"elevation\",\"Type\":\"double\"},{\"Name\":\"hourly_units.time\",\"Type\":\"string\"},{\"Name\":\"hourly_units.temperature_2m\",\"Type\":\"string\"},{\"Name\":\"hourly.time\",\"Type\":\"array<string>\"},{\"Name\":\"hourly.temperature_2m\",\"Type\":\"array<double>\"},{\"Name\":\"houry_time\",\"Type\":\"string\"}]}],\"Parameters\":[{\"IsOptional\":false,\"Name\":\"colName\",\"Type\":\"str\",\"Value\":[\"`hourly.time`\"]},{\"IsOptional\":false,\"Name\":\"newCol\",\"Type\":\"str\",\"Value\":[\"houry_time\"]},{\"IsOptional\":true,\"Name\":\"outer\",\"Type\":\"bool\",\"Value\":[\"true\"]}],\"Path\":\"s3://aws-glue-studio-transforms-737106620487-prod-ap-southeast-1/gs_explode.py\",\"TransformName\":\"gs_explode\",\"Version\":\"1.0.0\"}},\"node-1741668277070\":{\"ApplyMapping\":{\"Inputs\":[\"node-1741667366290\"],\"Mapping\":[{\"Dropped\":false,\"FromPath\":[\"LATITUDE\"],\"FromType\":\"decimal\",\"ToKey\":\"LATITUDE\",\"ToType\":\"decimal\"},{\"Dropped\":false,\"FromPath\":[\"LONGITUDE\"],\"FromType\":\"decimal\",\"ToKey\":\"LONGITUDE\",\"ToType\":\"decimal\"},{\"Dropped\":true,\"FromPath\":[\"houry_time\"],\"FromType\":\"timestamp\",\"ToKey\":\"houry_time\",\"ToType\":\"timestamp\"},{\"Dropped\":false,\"FromPath\":[\"FORECAST_TEMP\"],\"FromType\":\"decimal\",\"ToKey\":\"FORECAST_TEMP\",\"ToType\":\"decimal\"},{\"Dropped\":false,\"FromPath\":[\"hourly_units.temperature_2m\"],\"FromType\":\"string\",\"ToKey\":\"FORECAST_TEMP_UNIT\",\"ToType\":\"varchar\"},{\"Dropped\":false,\"FromPath\":[\"FORECAST_DATE\"],\"FromType\":\"string\",\"ToKey\":\"FORECAST_DATE\",\"ToType\":\"date\"},{\"Dropped\":false,\"FromPath\":[\"FORECAST_TIME\"],\"FromType\":\"string\",\"ToKey\":\"FORECAST_TIME\",\"ToType\":\"varchar\"}],\"Name\":\"Change Schema\"}}}",
  "sourceControlDetails" : {
    "provider" : "GITHUB",
    "repository" : "tmg-glue-job-poc",
    "branch" : "main",
    "folder" : "glue-json-load2redshift"
  }
}