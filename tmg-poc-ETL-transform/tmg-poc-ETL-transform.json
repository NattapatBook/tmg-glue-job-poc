{
  "name" : "tmg-poc-ETL-transform",
  "jobMode" : "VISUAL",
  "description" : "",
  "role" : "arn:aws:iam::863518427397:role/tmg-glue-service-role",
  "executionProperty" : {
    "maxConcurrentRuns" : 1
  },
  "command" : {
    "name" : "glueetl",
    "scriptLocation" : "s3://aws-glue-assets-863518427397-ap-southeast-1/scripts/tmg-poc-ETL-transform.py",
    "pythonVersion" : "3"
  },
  "defaultArguments" : {
    "--enable-metrics" : "true",
    "--enable-spark-ui" : "true",
    "--extra-py-files" : "s3://aws-glue-studio-transforms-737106620487-prod-ap-southeast-1/gs_common.py,s3://aws-glue-studio-transforms-737106620487-prod-ap-southeast-1/gs_now.py",
    "--spark-event-logs-path" : "s3://aws-glue-assets-863518427397-ap-southeast-1/sparkHistoryLogs/",
    "--enable-job-insights" : "true",
    "--enable-observability-metrics" : "true",
    "--enable-glue-datacatalog" : "true",
    "--enable-continuous-cloudwatch-log" : "true",
    "--job-bookmark-option" : "job-bookmark-disable",
    "--job-language" : "python",
    "--TempDir" : "s3://aws-glue-assets-863518427397-ap-southeast-1/temporary/"
  },
  "connections" : {
    "connections" : [ "redshift-jdbc-tmg-rs-stg-poc", "redshift-jdbc-tmg-rs-poc" ]
  },
  "maxRetries" : 0,
  "allocatedCapacity" : 2,
  "timeout" : 480,
  "maxCapacity" : 2.0,
  "glueVersion" : "5.0",
  "numberOfWorkers" : 2,
  "workerType" : "G.1X",
  "executionClass" : "STANDARD",
  "codeGenConfigurationNodes" : "{\"node-1742205289943\":{\"SparkSQL\":{\"Inputs\":[\"node-1742204687223\"],\"Name\":\"SQL Query\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"TRANSACTION_NUMBER\",\"Type\":\"string\"},{\"Name\":\"TRANSACTION_DATE\",\"Type\":\"date\"},{\"Name\":\"TRANSACTION_TIME\",\"Type\":\"string\"},{\"Name\":\"TERMINAL_ID\",\"Type\":\"string\"},{\"Name\":\"TICKET_ID\",\"Type\":\"string\"},{\"Name\":\"RETAILSTOREID\",\"Type\":\"string\"},{\"Name\":\"MATERIALNUMBER\",\"Type\":\"string\"},{\"Name\":\"TRANSACTION_TYPE\",\"Type\":\"string\"},{\"Name\":\"PLANT_CODE\",\"Type\":\"string\"},{\"Name\":\"CUSTOMER_ID\",\"Type\":\"string\"},{\"Name\":\"MATERIAL_CODE\",\"Type\":\"string\"},{\"Name\":\"MATERIAL_QTY\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"GROSSSALES\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"NETSALES\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"DISCOUNT\",\"Type\":\"decimal(10,2)\"}]}],\"SqlAliases\":[{\"Alias\":\"myDataSource\",\"From\":\"node-1742204687223\"}],\"SqlQuery\":\"SELECT\\r\\n    TRANSNUMBER AS TRANSACTION_NUMBER, \\r\\n    BUSINESSDAYDATE AS TRANSACTION_DATE,\\r\\n    BEGINTIMESTAMP AS TRANSACTION_TIME, \\r\\n    SUBSTRING(TRANSNUMBER, 11, 5) AS TERMINAL_ID, \\r\\n    SUBSTRING(TRANSNUMBER,16,5) AS TICKET_ID, \\r\\n    SUBSTRING(RETAILSTOREID,1,2) AS RETAILSTOREID,\\r\\n    MATERIALNUMBER,\\r\\n    -- TRANSTYPECODE,\\r\\n    CASE\\r\\n        WHEN MATERIALNUMBER = 'ADVANCE' THEN \\r\\n            CASE\\r\\n                WHEN TRANSTYPECODE = 'Z001' THEN 'Normal Sales (Deposit)'\\r\\n                WHEN TRANSTYPECODE = 'Z099' THEN 'Sales Return (Deposit)'\\r\\n                ELSE 'Unidentified'\\r\\n            END\\r\\n        WHEN MATERIALNUMBER != 'ADVANCE' THEN\\r\\n            CASE\\r\\n                WHEN TRANSTYPECODE = 'Z001' THEN 'Normal Sales'\\r\\n                WHEN TRANSTYPECODE = 'Z099' THEN 'Sales Return'\\r\\n                WHEN TRANSTYPECODE = 'ZCDS' THEN 'Customer Delivery Sales'\\r\\n                WHEN TRANSTYPECODE = 'ZBLS' THEN 'Biglot Sales'\\r\\n                WHEN TRANSTYPECODE = 'ZCRE' THEN 'Customer Credit Sales'\\r\\n                WHEN TRANSTYPECODE = 'ZEMS' THEN 'Embassy Sales'\\r\\n                ELSE 'Unidentified'\\r\\n            END\\r\\n    END AS TRANSACTION_TYPE,\\r\\n    RETAILSTOREID AS PLANT_CODE,\\r\\n    CUSTCARDNUMBER AS CUSTOMER_ID,\\r\\n    MATERIALNUMBER AS MATERIAL_CODE,\\r\\n    SUM(RETAILQUANTITY) AS MATERIAL_QTY,\\r\\n    SUM(NORMALSALESAMT) AS GROSSSALES,\\r\\n    SUM(SALESAMOUNT) AS NETSALES,\\r\\n    NORMALSALESAMT - SALESAMOUNT AS DISCOUNT\\r\\nFROM\\r\\n    myDataSource\\r\\n    WHERE RECORDQUALIFIER = '5' OR\\r\\n    RECORDQUALIFIER = '26'\\r\\n    GROUP BY TRANSACTION_NUMBER, TRANSACTION_DATE, TRANSACTION_TIME, TERMINAL_ID, TICKET_ID, RETAILSTOREID, TRANSACTION_TYPE, PLANT_CODE, CUSTOMER_ID, MATERIAL_CODE, DISCOUNT;\"}},\"node-1742205798333\":{\"ApplyMapping\":{\"Inputs\":[\"node-1742205515455\"],\"Mapping\":[{\"Dropped\":false,\"FromPath\":[\"TRANSACTION_NUMBER\"],\"FromType\":\"string\",\"ToKey\":\"TRANSACTION_NUMBER\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"TRANSACTION_DATE\"],\"FromType\":\"date\",\"ToKey\":\"TRANSACTION_DATE\",\"ToType\":\"date\"},{\"Dropped\":true,\"FromPath\":[\"TRANSACTION_TIME\"],\"FromType\":\"string\",\"ToKey\":\"TRANSACTION_TIME\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"TERMINAL_ID\"],\"FromType\":\"string\",\"ToKey\":\"TERMINAL_ID\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"TICKET_ID\"],\"FromType\":\"string\",\"ToKey\":\"TICKET_ID\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"RETAILSTOREID\"],\"FromType\":\"string\",\"ToKey\":\"RETAILSTOREID\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"MATERIALNUMBER\"],\"FromType\":\"string\",\"ToKey\":\"MATERIAL_CODE\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"TRANSACTION_TYPE\"],\"FromType\":\"string\",\"ToKey\":\"TRANSACTION_TYPE\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"PLANT_CODE\"],\"FromType\":\"string\",\"ToKey\":\"PLANT_CODE\",\"ToType\":\"string\"},{\"Dropped\":true,\"FromPath\":[\"CUSTOMER_ID\"],\"FromType\":\"string\",\"ToKey\":\"CUSTOMER_ID\",\"ToType\":\"string\"},{\"Dropped\":true,\"FromPath\":[\"MATERIAL_CODE\"],\"FromType\":\"string\",\"ToKey\":\"MATERIAL_CODE\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"MATERIAL_QTY\"],\"FromType\":\"decimal\",\"ToKey\":\"MATERIAL_QTY\",\"ToType\":\"decimal\"},{\"Dropped\":false,\"FromPath\":[\"GROSSSALES\"],\"FromType\":\"decimal\",\"ToKey\":\"GROSSSALES\",\"ToType\":\"decimal\"},{\"Dropped\":false,\"FromPath\":[\"NETSALES\"],\"FromType\":\"decimal\",\"ToKey\":\"NETSALES\",\"ToType\":\"decimal\"},{\"Dropped\":false,\"FromPath\":[\"DISCOUNT\"],\"FromType\":\"decimal\",\"ToKey\":\"DISCOUNT\",\"ToType\":\"decimal\"},{\"Dropped\":true,\"FromPath\":[\"pattern\"],\"FromType\":\"string\",\"ToKey\":\"pattern\",\"ToType\":\"string\"},{\"Dropped\":true,\"FromPath\":[\"replacement\"],\"FromType\":\"string\",\"ToKey\":\"replacement\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"mask_cus_id\"],\"FromType\":\"string\",\"ToKey\":\"CUSTOMER_ID\",\"ToType\":\"varchar\"},{\"Dropped\":false,\"FromPath\":[\"iso_format_time\"],\"FromType\":\"string\",\"ToKey\":\"TRANSACTION_TIME\",\"ToType\":\"timestamp\"},{\"Dropped\":false,\"FromPath\":[\"system_upd_datetime\"],\"FromType\":\"string\",\"ToKey\":\"system_upd_datetime\",\"ToType\":\"timestamp\"}],\"Name\":\"Change Schema\"}},\"node-1742205515455\":{\"DynamicTransform\":{\"FunctionName\":\"gs_now\",\"Inputs\":[\"node-1742205482126\"],\"Name\":\"Add Current Timestamp\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"TRANSACTION_NUMBER\",\"Type\":\"string\"},{\"Name\":\"TRANSACTION_DATE\",\"Type\":\"date\"},{\"Name\":\"TRANSACTION_TIME\",\"Type\":\"string\"},{\"Name\":\"TERMINAL_ID\",\"Type\":\"string\"},{\"Name\":\"TICKET_ID\",\"Type\":\"string\"},{\"Name\":\"RETAILSTOREID\",\"Type\":\"string\"},{\"Name\":\"MATERIALNUMBER\",\"Type\":\"string\"},{\"Name\":\"TRANSACTION_TYPE\",\"Type\":\"string\"},{\"Name\":\"PLANT_CODE\",\"Type\":\"string\"},{\"Name\":\"CUSTOMER_ID\",\"Type\":\"string\"},{\"Name\":\"MATERIAL_CODE\",\"Type\":\"string\"},{\"Name\":\"MATERIAL_QTY\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"GROSSSALES\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"NETSALES\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"DISCOUNT\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"pattern\",\"Type\":\"string\"},{\"Name\":\"replacement\",\"Type\":\"string\"},{\"Name\":\"mask_cus_id\",\"Type\":\"string\"},{\"Name\":\"iso_format_time\",\"Type\":\"string\"},{\"Name\":\"system_upd_datetime\",\"Type\":\"string\"}]}],\"Parameters\":[{\"IsOptional\":true,\"Name\":\"colName\",\"Type\":\"str\",\"Value\":[\"system_upd_datetime\"]},{\"IsOptional\":true,\"Name\":\"dateFormat\",\"Type\":\"str\",\"Value\":[\"yyyy-MM-dd HH:mm:ss\"]}],\"Path\":\"s3://aws-glue-studio-transforms-737106620487-prod-ap-southeast-1/gs_now.py\",\"TransformName\":\"gs_now\",\"Version\":\"1.0.0\"}},\"node-1742205414402\":{\"CustomCode\":{\"ClassName\":\"MyTransform\",\"Code\":\"from pyspark.sql.functions import lpad, regexp_extract, regexp_replace, concat, expr, lit\\nfrom pyspark.sql.functions import date_format, to_date, to_timestamp\\ndf = dfc.select(list(dfc.keys())[0]).toDF()\\n\\ndf = df.withColumn('MATERIALNUMBER', lpad(df['MATERIALNUMBER'], 18, '0')) \\n\\ndf = df.withColumn(\\n\\\"pattern\\\", \\nregexp_extract(\\\"CUSTOMER_ID\\\", r\\\"(?<=.{5})\\\\w+(?=.{4})\\\", 0)\\n)\\ndf = df.withColumn(\\n\\\"replacement\\\",\\nregexp_replace(\\\"pattern\\\", r\\\"\\\\w\\\", \\\"X\\\")\\n)\\ndf = df.withColumn(\\n\\\"mask_cus_id\\\",\\nexpr(\\\"regexp_replace(CUSTOMER_ID, concat('(?<=.{5})', pattern, '(?=.{4})'), replacement)\\\")\\n)\\n\\ndf = df.withColumn(\\\"iso_format_time\\\", date_format(to_timestamp(\\\"TRANSACTION_TIME\\\", \\\"yyyyMMddHHmmss\\\"), \\\"yyyy-MM-dd'T'HH:mm:ss\\\"))\\n\\ndyf_filtered = DynamicFrame.fromDF(df, glueContext, \\\"filter_votes\\\")\\nreturn(DynamicFrameCollection({\\\"CustomTransform0\\\": dyf_filtered}, glueContext))\",\"Inputs\":[\"node-1742205289943\"],\"Name\":\"Spark Transform\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"TRANSACTION_NUMBER\",\"Type\":\"string\"},{\"Name\":\"TRANSACTION_DATE\",\"Type\":\"date\"},{\"Name\":\"TRANSACTION_TIME\",\"Type\":\"string\"},{\"Name\":\"TERMINAL_ID\",\"Type\":\"string\"},{\"Name\":\"TICKET_ID\",\"Type\":\"string\"},{\"Name\":\"RETAILSTOREID\",\"Type\":\"string\"},{\"Name\":\"MATERIALNUMBER\",\"Type\":\"string\"},{\"Name\":\"TRANSACTION_TYPE\",\"Type\":\"string\"},{\"Name\":\"PLANT_CODE\",\"Type\":\"string\"},{\"Name\":\"CUSTOMER_ID\",\"Type\":\"string\"},{\"Name\":\"MATERIAL_CODE\",\"Type\":\"string\"},{\"Name\":\"MATERIAL_QTY\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"GROSSSALES\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"NETSALES\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"DISCOUNT\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"pattern\",\"Type\":\"string\"},{\"Name\":\"replacement\",\"Type\":\"string\"},{\"Name\":\"mask_cus_id\",\"Type\":\"string\"},{\"Name\":\"iso_format_time\",\"Type\":\"string\"}]}]}},\"node-1742206312653\":{\"S3DirectTarget\":{\"AutoDataQuality\":{\"EvaluationContext\":\"EvaluateDataQuality_node1742204680462\",\"IsEnabled\":false},\"Compression\":\"none\",\"Format\":\"csv\",\"Inputs\":[\"node-1742206165647\"],\"Name\":\"Amazon S3\",\"PartitionKeys\":[],\"Path\":\"s3://tmg-s3-raw-poc/temp/final/\",\"SchemaChangePolicy\":{\"EnableUpdateCatalog\":false}}},\"node-1742206098123\":{\"Join\":{\"Columns\":[{\"From\":\"node-1742205798333\",\"Keys\":[[\"RETAILSTOREID\"]]},{\"From\":\"node-1742205924849\",\"Keys\":[[\"branch_source_id\"]]}],\"Inputs\":[\"node-1742205798333\",\"node-1742205924849\"],\"JoinType\":\"equijoin\",\"Name\":\"Join\"}},\"node-1742204687223\":{\"AmazonRedshiftSource\":{\"Data\":{\"AccessType\":\"connection\",\"Action\":\"append\",\"AdvancedOptions\":[],\"Connection\":{\"Description\":\"No description available. Version: 1\",\"Label\":\"redshift-jdbc-tmg-rs-stg-poc\",\"Value\":\"redshift-jdbc-tmg-rs-stg-poc\"},\"MergeAction\":\"simple\",\"MergeWhenMatched\":\"update\",\"MergeWhenNotMatched\":\"insert\",\"SampleQuery\":\"SELECT\\r\\n    TRANSNUMBER, \\r\\n    BUSINESSDAYDATE,\\r\\n    BEGINTIMESTAMP, \\r\\n    RETAILSTOREID,\\r\\n    MATERIALNUMBER,\\r\\n    TRANSTYPECODE,\\r\\n    CUSTCARDNUMBER,\\r\\n    RETAILQUANTITY,\\r\\n    NORMALSALESAMT,\\r\\n    SALESAMOUNT,\\r\\n    RECORDQUALIFIER\\r\\nFROM\\r\\n    \\\"poc_stg\\\".\\\"poc\\\".\\\"poc_raw\\\"\",\"Schema\":{\"Label\":\"poc\",\"Value\":\"poc\"},\"SelectedColumns\":[],\"SourceType\":\"query\",\"StagingTable\":\"poc.poc_raw_temp_iej1ne\",\"Table\":{\"Label\":\"poc_raw\",\"Value\":\"poc_raw\"},\"TableSchema\":[],\"TempDir\":\"s3://aws-glue-assets-863518427397-ap-southeast-1/temporary/\",\"Upsert\":false},\"Name\":\"POC_RAW\"}},\"node-1742205924849\":{\"AmazonRedshiftSource\":{\"Data\":{\"AccessType\":\"connection\",\"Action\":\"append\",\"AdvancedOptions\":[],\"Connection\":{\"Description\":\"JDBC for Redshift tmg-rs-poc, Database poc_dwh Version: 1\",\"Label\":\"redshift-jdbc-tmg-rs-poc\",\"Value\":\"redshift-jdbc-tmg-rs-poc\"},\"MergeAction\":\"simple\",\"MergeWhenMatched\":\"update\",\"MergeWhenNotMatched\":\"insert\",\"Schema\":{\"Label\":\"poc\",\"Value\":\"poc\"},\"SelectedColumns\":[],\"SourceType\":\"table\",\"StagingTable\":\"poc.poc_branch_dim_temp_b0v9mh\",\"Table\":{\"Label\":\"poc_branch_dim\",\"Value\":\"poc_branch_dim\"},\"TableSchema\":[],\"TempDir\":\"s3://aws-glue-assets-863518427397-ap-southeast-1/temporary/\",\"Upsert\":false},\"Name\":\"Branch DIM\"}},\"node-1742205482126\":{\"SelectFromCollection\":{\"Index\":0,\"Inputs\":[\"node-1742205414402\"],\"Name\":\"Select From Spark Trans\"}},\"node-1742206165647\":{\"ApplyMapping\":{\"Inputs\":[\"node-1742206098123\"],\"Mapping\":[{\"Dropped\":false,\"FromPath\":[\"TRANSACTION_NUMBER\"],\"FromType\":\"string\",\"ToKey\":\"TRANSACTION_NUMBER\",\"ToType\":\"varchar\"},{\"Dropped\":false,\"FromPath\":[\"TRANSACTION_DATE\"],\"FromType\":\"date\",\"ToKey\":\"TRANSACTION_DATE\",\"ToType\":\"date\"},{\"Dropped\":false,\"FromPath\":[\"TERMINAL_ID\"],\"FromType\":\"string\",\"ToKey\":\"TERMINAL_ID\",\"ToType\":\"varchar\"},{\"Dropped\":false,\"FromPath\":[\"TICKET_ID\"],\"FromType\":\"string\",\"ToKey\":\"TICKET_ID\",\"ToType\":\"varchar\"},{\"Dropped\":true,\"FromPath\":[\"RETAILSTOREID\"],\"FromType\":\"string\",\"ToKey\":\"RETAILSTOREID\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"MATERIAL_CODE\"],\"FromType\":\"string\",\"ToKey\":\"MATERIAL_CODE\",\"ToType\":\"varchar\"},{\"Dropped\":false,\"FromPath\":[\"TRANSACTION_TYPE\"],\"FromType\":\"string\",\"ToKey\":\"TRANSACTION_TYPE\",\"ToType\":\"varchar\"},{\"Dropped\":false,\"FromPath\":[\"PLANT_CODE\"],\"FromType\":\"string\",\"ToKey\":\"PLANT_CODE\",\"ToType\":\"varchar\"},{\"Dropped\":false,\"FromPath\":[\"MATERIAL_QTY\"],\"FromType\":\"decimal\",\"ToKey\":\"MATERIAL_QTY\",\"ToType\":\"decimal\"},{\"Dropped\":false,\"FromPath\":[\"GROSSSALES\"],\"FromType\":\"decimal\",\"ToKey\":\"GROSSSALES\",\"ToType\":\"decimal\"},{\"Dropped\":false,\"FromPath\":[\"NETSALES\"],\"FromType\":\"decimal\",\"ToKey\":\"NETSALES\",\"ToType\":\"decimal\"},{\"Dropped\":false,\"FromPath\":[\"DISCOUNT\"],\"FromType\":\"decimal\",\"ToKey\":\"DISCOUNT\",\"ToType\":\"decimal\"},{\"Dropped\":false,\"FromPath\":[\"CUSTOMER_ID\"],\"FromType\":\"varchar\",\"ToKey\":\"CUSTOMER_ID\",\"ToType\":\"varchar\"},{\"Dropped\":false,\"FromPath\":[\"TRANSACTION_TIME\"],\"FromType\":\"timestamp\",\"ToKey\":\"TRANSACTION_TIME\",\"ToType\":\"timestamp\"},{\"Dropped\":false,\"FromPath\":[\"system_upd_datetime\"],\"FromType\":\"timestamp\",\"ToKey\":\"system_upd_datetime\",\"ToType\":\"timestamp\"},{\"Dropped\":false,\"FromPath\":[\"branch_id\"],\"FromType\":\"int\",\"ToKey\":\"STORE_ID\",\"ToType\":\"int\"},{\"Dropped\":true,\"FromPath\":[\"branch_source_id\"],\"FromType\":\"string\",\"ToKey\":\"branch_source_id\",\"ToType\":\"string\"},{\"Dropped\":true,\"FromPath\":[\"branch_name\"],\"FromType\":\"string\",\"ToKey\":\"branch_name\",\"ToType\":\"string\"},{\"Dropped\":true,\"FromPath\":[\"branch_name_th\"],\"FromType\":\"string\",\"ToKey\":\"branch_name_th\",\"ToType\":\"string\"},{\"Dropped\":true,\"FromPath\":[\"branch_name_en\"],\"FromType\":\"string\",\"ToKey\":\"branch_name_en\",\"ToType\":\"string\"},{\"Dropped\":true,\"FromPath\":[\"branch_group\"],\"FromType\":\"string\",\"ToKey\":\"branch_group\",\"ToType\":\"string\"}],\"Name\":\"Change Schema\"}},\"node-1742206337384\":{\"AmazonRedshiftTarget\":{\"Data\":{\"AccessType\":\"connection\",\"Action\":\"append\",\"AdvancedOptions\":[],\"Connection\":{\"Description\":\"JDBC for Redshift tmg-rs-poc, Database poc_dwh Version: 1\",\"Label\":\"redshift-jdbc-tmg-rs-poc\",\"Value\":\"redshift-jdbc-tmg-rs-poc\"},\"MergeAction\":\"simple\",\"MergeWhenMatched\":\"update\",\"MergeWhenNotMatched\":\"insert\",\"Schema\":{\"Label\":\"poc\",\"Value\":\"poc\"},\"SelectedColumns\":[],\"SourceType\":\"table\",\"StagingTable\":\"poc.poc_fact_sales_temp_7cbiqp\",\"Table\":{\"Label\":\"poc_fact_sales\",\"Value\":\"poc_fact_sales\"},\"TableSchema\":[{\"Description\":\"VARCHAR\",\"Label\":\"TRANSACTION_NUMBER\",\"Value\":\"TRANSACTION_NUMBER\"},{\"Description\":\"DATE\",\"Label\":\"TRANSACTION_DATE\",\"Value\":\"TRANSACTION_DATE\"},{\"Description\":\"VARCHAR\",\"Label\":\"TERMINAL_ID\",\"Value\":\"TERMINAL_ID\"},{\"Description\":\"VARCHAR\",\"Label\":\"TICKET_ID\",\"Value\":\"TICKET_ID\"},{\"Description\":\"VARCHAR\",\"Label\":\"MATERIAL_CODE\",\"Value\":\"MATERIAL_CODE\"},{\"Description\":\"VARCHAR\",\"Label\":\"TRANSACTION_TYPE\",\"Value\":\"TRANSACTION_TYPE\"},{\"Description\":\"VARCHAR\",\"Label\":\"PLANT_CODE\",\"Value\":\"PLANT_CODE\"},{\"Description\":\"DECIMAL\",\"Label\":\"MATERIAL_QTY\",\"Value\":\"MATERIAL_QTY\"},{\"Description\":\"DECIMAL\",\"Label\":\"GROSSSALES\",\"Value\":\"GROSSSALES\"},{\"Description\":\"DECIMAL\",\"Label\":\"NETSALES\",\"Value\":\"NETSALES\"},{\"Description\":\"DECIMAL\",\"Label\":\"DISCOUNT\",\"Value\":\"DISCOUNT\"},{\"Description\":\"VARCHAR\",\"Label\":\"CUSTOMER_ID\",\"Value\":\"CUSTOMER_ID\"},{\"Description\":\"TIMESTAMP\",\"Label\":\"TRANSACTION_TIME\",\"Value\":\"TRANSACTION_TIME\"},{\"Description\":\"TIMESTAMP\",\"Label\":\"system_upd_datetime\",\"Value\":\"system_upd_datetime\"},{\"Description\":\"INTEGER\",\"Label\":\"STORE_ID\",\"Value\":\"STORE_ID\"}],\"TempDir\":\"s3://aws-glue-assets-863518427397-ap-southeast-1/temporary/\",\"Upsert\":false},\"Inputs\":[\"node-1742206165647\"],\"Name\":\"Amazon Redshift\"}}}",
  "sourceControlDetails" : {
    "provider" : "GITHUB",
    "repository" : "tmg-glue-job-poc",
    "branch" : "main",
    "folder" : "tmg-poc-ETL-transform"
  }
}